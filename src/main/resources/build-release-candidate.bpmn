<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:zeebe="http://camunda.org/schema/zeebe/1.0" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:modeler="http://camunda.org/schema/modeler/1.0" id="Definitions_01wel5n" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.3.0" modeler:executionPlatform="Camunda Cloud" modeler:executionPlatformVersion="8.0.0">
  <bpmn:process id="Process_1w8vftu" name="build-release-candidate" isExecutable="true">
    <bpmn:extensionElements>
      <zeebe:userTaskForm id="UserTaskForm_38jg436">{
  "schemaVersion": 2,
  "components": [
    {
      "label": "Current release process",
      "type": "textfield",
      "id": "Field_0zdbd7q",
      "key": "release_version"
    },
    {
      "text": "# Run the release pipeline\n\nThe Zeebe release pipeline runs on the same Jenkins instance as the CI pipeline, [here](https://ci.zeebe.camunda.cloud/job/zeebe-release/).  The pipeline itself lives in the Zeebe repository, [here](https://github.com/camunda-cloud/zeebe/blob/develop/.ci/pipelines/release_zeebe.groovy). In short, it will build the release branch, stage and deploy Maven and Docker artifacts, tag the release, and update the version for the next development iteration. \n\n[Create a new build](https://ci.zeebe.camunda.cloud/job/zeebe-release/build?delay=0sec), and fill in the parameters accordingly.\n\n  \n**Alpha release**\n```\nRELEASE_VERSION: MAJOR.MINOR.0-ALPHA\nDEVELOPMENT_VERSION: MAJOR.MINOR.0-SNAPSHOT\nPUSH_CHANGES: true\nPUSH_DOCKER: true\nIS_LATEST: false\n```\n\n  \n**Patch release**\n\n&gt; **NOTE**: here the development version is MAJOR.MINOR.PATCH+1-SNAPSHOT. So if you have your release version is `1.2.1`, then the next development version will be `1.2.2-SNAPSHOT`.\n\n&gt; **NOTE**: if you are release a patch release for the latest minor release, then `IS_LATEST` should be set to `true`.\n\n```\nRELEASE_VERSION: MAJOR.MINOR.PATCH\nDEVELOPMENT_VERSION: MAJOR.MINOR.PATCH+1-SNAPSHOT\nPUSH_CHANGES: true\nPUSH_DOCKER: true\nIS_LATEST: false\n```\n\n  \n**Minor release**\n\n&gt; **NOTE**: here the development version is MAJOR.MINOR+1.0-SNAPSHOT. So if you have your release version is `1.2.0`, then the next development version will be `1.3.0-SNAPSHOT`.\n\n```\nRELEASE_VERSION: MAJOR.MINOR.0\nDEVELOPMENT_VERSION: MAJOR.MINOR+1.0-SNAPSHOT\nPUSH_CHANGES: true\nPUSH_DOCKER: true\nIS_LATEST: true\n```\n  \n  \nClick `Build` to start the release process, and wait until the pipeline finishes successfully.\n\nHints:\n- Sometimes the release process will fail. It's currently necessary to manually rollback the changes before restarting again. To roll back the changes, you will need to delete any tags that the job may have created (you can do so via the Github Web UI), and also drop the additional commits that the job added on the release branch, such that it's in the state it was before running the job. You may also have to drop the Maven artifacts on Maven central, [here](https://s01.oss.sonatype.org/).\n- If unsure about anything, ask the team and/or your tech lead.",
      "type": "text",
      "id": "Field_05xq34i"
    }
  ],
  "type": "default",
  "id": "Form_1ituz9d"
}</zeebe:userTaskForm>
      <zeebe:userTaskForm id="UserTaskForm_2j128s3">{
  "schemaVersion": 2,
  "components": [
    {
      "label": "Current release process",
      "type": "textfield",
      "id": "Field_01aedoc",
      "key": "release_version"
    },
    {
      "text": "# Release the Maven artifacts\n\nOnce the pipeline was successfully finished, the Docker artifacts will already be available publicly. We now have to release the Maven central ones.\n\n1. Go to [Maven Central](https://s01.oss.sonatype.org/) and login using the shared `Maven Central` credentials for login `camundabpm` found in [Keeper](https://keepersecurity.eu/vault/) under `Shared-Engineering - Zeebe`. \n2. On the left side, click on the 'Staging Repositories' link.\n3. After it has been loaded, scroll down to the bottom of the list. You should find the relevant Zeebe staging repositories there.\n4. Mark the repository you want to release, which should be one for zeebe.\n\n&gt; io.camunda:zeebe*\n\n\n5. Click on 'Release' at the menu on top of the list. A window will pop up were you can enter a description but it is not necessary. Activate 'Drop repository after release automatically'. Then proceed.\n6. Done.",
      "type": "text",
      "id": "Field_10avz1w"
    }
  ],
  "type": "default",
  "id": "Form_1tx0oak"
}</zeebe:userTaskForm>
    </bpmn:extensionElements>
    <bpmn:startEvent id="StartEvent_1" name="Build release candidate">
      <bpmn:outgoing>Flow_1yahb20</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:userTask id="Activity_0wjyoge" name="Trigger release candidate">
      <bpmn:extensionElements>
        <zeebe:formDefinition formKey="camunda-forms:bpmn:UserTaskForm_38jg436" />
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1yahb20</bpmn:incoming>
      <bpmn:outgoing>Flow_0laljwe</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:userTask id="Activity_0x73wcr" name="Release on Maven Central">
      <bpmn:extensionElements>
        <zeebe:formDefinition formKey="camunda-forms:bpmn:UserTaskForm_2j128s3" />
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0laljwe</bpmn:incoming>
      <bpmn:outgoing>Flow_0sjbp2b</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:serviceTask id="notify-others" name="Notify other teams" zeebe:modelerTemplate="io.camunda.connectors.Slack.v1" zeebe:modelerTemplateIcon="data:image/svg+xml;utf8,%3Csvg%20width%3D%2218%22%20height%3D%2218%22%20%20viewBox%3D%220%200%20127%20127%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%20%20%3Cpath%20d%3D%22M27.2%2080c0%207.3-5.9%2013.2-13.2%2013.2C6.7%2093.2.8%2087.3.8%2080c0-7.3%205.9-13.2%2013.2-13.2h13.2V80zm6.6%200c0-7.3%205.9-13.2%2013.2-13.2%207.3%200%2013.2%205.9%2013.2%2013.2v33c0%207.3-5.9%2013.2-13.2%2013.2-7.3%200-13.2-5.9-13.2-13.2V80z%22%20fill%3D%22%23E01E5A%22%2F%3E%0A%20%20%3Cpath%20d%3D%22M47%2027c-7.3%200-13.2-5.9-13.2-13.2C33.8%206.5%2039.7.6%2047%20.6c7.3%200%2013.2%205.9%2013.2%2013.2V27H47zm0%206.7c7.3%200%2013.2%205.9%2013.2%2013.2%200%207.3-5.9%2013.2-13.2%2013.2H13.9C6.6%2060.1.7%2054.2.7%2046.9c0-7.3%205.9-13.2%2013.2-13.2H47z%22%20fill%3D%22%2336C5F0%22%2F%3E%0A%20%20%3Cpath%20d%3D%22M99.9%2046.9c0-7.3%205.9-13.2%2013.2-13.2%207.3%200%2013.2%205.9%2013.2%2013.2%200%207.3-5.9%2013.2-13.2%2013.2H99.9V46.9zm-6.6%200c0%207.3-5.9%2013.2-13.2%2013.2-7.3%200-13.2-5.9-13.2-13.2V13.8C66.9%206.5%2072.8.6%2080.1.6c7.3%200%2013.2%205.9%2013.2%2013.2v33.1z%22%20fill%3D%22%232EB67D%22%2F%3E%0A%20%20%3Cpath%20d%3D%22M80.1%2099.8c7.3%200%2013.2%205.9%2013.2%2013.2%200%207.3-5.9%2013.2-13.2%2013.2-7.3%200-13.2-5.9-13.2-13.2V99.8h13.2zm0-6.6c-7.3%200-13.2-5.9-13.2-13.2%200-7.3%205.9-13.2%2013.2-13.2h33.1c7.3%200%2013.2%205.9%2013.2%2013.2%200%207.3-5.9%2013.2-13.2%2013.2H80.1z%22%20fill%3D%22%23ECB22E%22%2F%3E%0A%3C%2Fsvg%3E%0A">
      <bpmn:extensionElements>
        <zeebe:taskDefinition type="io.camunda:slack:1" />
        <zeebe:ioMapping>
          <zeebe:input source="chat.postMessage" target="method" />
          <zeebe:input source="secrets.SLACK_OAUTH_TOKEN" target="token" />
          <zeebe:input source="#c8-release-announcements" target="data.channel" />
          <zeebe:input source="= &#34;Hi :wave: team! There is a new Zeebe version &#34; + release_version + &#34; available that you can test against.&#34;" target="data.text" />
        </zeebe:ioMapping>
        <zeebe:taskHeaders>
          <zeebe:header key="resultVariable" />
          <zeebe:header key="resultExpression" />
        </zeebe:taskHeaders>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0sjbp2b</bpmn:incoming>
      <bpmn:outgoing>Flow_1g3i425</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:callActivity id="Activity_1aiu7sp" name="Release Zeebe process test">
      <bpmn:extensionElements>
        <zeebe:calledElement processId="zeebe-process-test-release" propagateAllChildVariables="false" />
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1g3i425</bpmn:incoming>
      <bpmn:outgoing>Flow_0084v7j</bpmn:outgoing>
    </bpmn:callActivity>
    <bpmn:sequenceFlow id="Flow_0laljwe" sourceRef="Activity_0wjyoge" targetRef="Activity_0x73wcr" />
    <bpmn:sequenceFlow id="Flow_0sjbp2b" sourceRef="Activity_0x73wcr" targetRef="notify-others" />
    <bpmn:sequenceFlow id="Flow_1g3i425" sourceRef="notify-others" targetRef="Activity_1aiu7sp" />
    <bpmn:sequenceFlow id="Flow_1yahb20" sourceRef="StartEvent_1" targetRef="Activity_0wjyoge" />
    <bpmn:endEvent id="Event_00xlnce" name="Release candidate built">
      <bpmn:incoming>Flow_0084v7j</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_0084v7j" sourceRef="Activity_1aiu7sp" targetRef="Event_00xlnce" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1w8vftu">
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
        <dc:Bounds x="179" y="99" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="166" y="142" width="64" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0k10z92" bpmnElement="Activity_0wjyoge">
        <dc:Bounds x="270" y="77" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1xi5jc4" bpmnElement="Activity_0x73wcr">
        <dc:Bounds x="420" y="77" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0v48l92_di" bpmnElement="notify-others">
        <dc:Bounds x="550" y="77" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0sfwg0q" bpmnElement="Activity_1aiu7sp">
        <dc:Bounds x="700" y="77" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_00xlnce_di" bpmnElement="Event_00xlnce">
        <dc:Bounds x="852" y="99" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="835" y="142" width="71" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_0laljwe_di" bpmnElement="Flow_0laljwe">
        <di:waypoint x="370" y="117" />
        <di:waypoint x="420" y="117" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0sjbp2b_di" bpmnElement="Flow_0sjbp2b">
        <di:waypoint x="520" y="117" />
        <di:waypoint x="550" y="117" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1g3i425_di" bpmnElement="Flow_1g3i425">
        <di:waypoint x="650" y="117" />
        <di:waypoint x="700" y="117" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1yahb20_di" bpmnElement="Flow_1yahb20">
        <di:waypoint x="215" y="117" />
        <di:waypoint x="270" y="117" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0084v7j_di" bpmnElement="Flow_0084v7j">
        <di:waypoint x="800" y="117" />
        <di:waypoint x="852" y="117" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
